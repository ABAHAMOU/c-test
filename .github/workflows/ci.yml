name: Cross-Platform Build Test

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  build-linux:
    name: üêß Linux Build
    runs-on: ubuntu-latest
    steps:
      - name: üì• Checkout code
        uses: actions/checkout@v3
      
      - name: üì¶ Install SDL2
        run: |
          sudo apt-get update
          sudo apt-get install -y libsdl2-dev pkg-config
      
      - name: üî® Compile
        run: |
          g++ -g -Wall -Wextra -o prog *.cpp $(pkg-config --cflags --libs sdl2)
      
      - name: ‚úÖ Verify build
        run: |
          if [ -f prog ]; then
            echo "‚úÖ Linux build successful!"
          else
            echo "‚ùå Build failed!"
            exit 1
          fi

  build-macos:
    name: üçé macOS Build
    runs-on: macos-latest
    steps:
      - name: üì• Checkout code
        uses: actions/checkout@v3
      
      - name: üì¶ Install SDL2
        run: |
          brew install sdl2 pkg-config
      
      - name: ÔøΩÔøΩ Compile
        run: |
          g++ -g -Wall -Wextra -o prog *.cpp $(pkg-config --cflags --libs sdl2)
      
      - name: ‚úÖ Verify build
        run: |
          if [ -f prog ]; then
            echo "‚úÖ macOS build successful!"
          else
            echo "‚ùå Build failed!"
            exit 1
          fi

  build-windows:
    name: ü™ü Windows (MinGW) Build
    runs-on: windows-latest
    defaults:
      run:
        shell: msys2 {0}
    steps:
      - name: üì• Checkout code
        uses: actions/checkout@v3
      
      - name: üîß Setup MSYS2
        uses: msys2/setup-msys2@v2
        with:
          msystem: MINGW64
          update: false
          install: >-
            mingw-w64-x86_64-gcc
            mingw-w64-x86_64-SDL2
            mingw-w64-x86_64-pkg-config
      
      - name: üî® Compile
        run: |
          g++ -g -Wall -Wextra -o prog.exe *.cpp $(pkg-config --cflags --libs sdl2)
      
      - name: ‚úÖ Verify build
        run: |
          if [ -f prog.exe ]; then
            echo "‚úÖ Windows build successful!"
            ls -lh prog.exe
          else
            echo "‚ùå Build failed!"
            exit 1
          fi
EOF